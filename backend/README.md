# Backend сервиса Academrecycle

### Запуск бэкенда:
В каталоге проекта следующие скрипты доступны для запуска:
1. npm install - установка нужных библиотек
2. npm run start - запуск бэкенда
3. npm run migrate – применение всех миграций и добавление изначальных городов
4. npm run migrate:rollback – откат всех миграций

Сервер будет доступен на [http://localhost:9000](http://localhost:9000).

### Структура .env:
* `PORT`: порт, на котором будет висеть бэкенд *(default: 9000)*
* `DBHOST`: host базы данных *(default: localhost)*
* `DBUSER`: user базы данных *(default: postgres)*
* `DBPASSWORD`: пароль базы данных *(default: root)*
* `DBPORT`: порт базы данных *(default: 5432)*
* `DBNAME`: названии базы данных *(default: test)*
* `DIALECT`: диалект базы данных *(default: postgres)*
* `MAX`: максимальное кол-во соединений в пуле *(default: 5)*
* `MIN`: минимальное кол-во соединений в пуле *(default: 0)*
* `ACQUIRE`: время в миллисекундах, в течение которого будет осуществляться попытка установить соединение, прежде чем будет сгенерировано исключение *(default: 30000)*
* `IDLE`: время простоя в миллисекундах, по истечении которого соединение покинет пул *(default: 10000)*

### Файл migrate_points.js:
Для запуска используется команда `node migrate_points.js`
Данный скрипт обрабатывает файлы с данными в формате JSON.
Название файла должно соответствовать с названием города которое присутствует в таблице *(Например: Новосибирск.json)*.

### Содержание файлов .json на примере города Красноярска
```jsonc
{
  "5130": {   // ID из системы recyclemap.ru
    "id": "5130",   // ID из системы recyclemap.ru
    "lat": "56.007424", // Широта
    "lng": "92.872708", // Долгота
    "city": "Красноярск", // Город
    "title": "Красноярский краевой краеведческий музей", // Название пункта приёма
    "content_text": "Батарейки", // Тип принимаемых отходов
    "address": "ул. Дубровинского, 84" // Адрес пункта приёма
  }
}
```
